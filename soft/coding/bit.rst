
.. index:: bit演算

.. _bit演算:

bit演算
==========
| 主にレジスタの値を編集するためによく使用される。
| CPUが内部でどのような処理をしているのかについて説明する。

.. code-block:: c

    P_HOGE_REG |= 0x40;

| といった演算があった場合、単にレジスタの値の6bit目を1にしているだけではない。
| そもそもCPUは最低でも1byteサイズでしかメモリにアクセスできない為、
| C言語上で省略されていても内部ではこのように処理される。

.. code-block:: c
    :linenos:

    unsigned char tmp;

    tmp = P_HOGE_REG;
    tmp = tmp | 0x40;
    P_HOGE_REG = tmp;

| この時、3行目と5行目の間で他のbitが変更されていても
| 5行目の処理によって以前の値に上書きしてしまう。
| それを回避するために、レジスタ等複数から同時にアクセスされる恐れのあるものについては、
| 制御中は割り禁を行うことがルールとなっている。

