

.. index:: 割り込み関数

.. _割り込み関数:

割り込み関数
==================
| 割り込みで使用される関数のことだが、他の関数とは異なる定義をする必要がある。
| それはコンパイル時にこれは通常の関数でなく割り込み関数ですよと明示する事である。
| 通常の関数がサブ関数をCallする場合は、Stackに以下のものを積んでCallする。

* 引数
    実行するために必要

* Callしたアドレス
    実行後に元の関数へ戻ってくるためのメモ書き

* 戻り値を格納する領域
* 現在のローカル変数
* Callした時のStackアドレス
    実行後に元の関数の処理を復旧させるためのメモ書き

| これは、Call後にCall元の関数へ現状復帰する為のメモ書きである。
| しかし、割り込み関数のCall元は現在実行中の処理ではなくマイコン自身となる為、
| この積む内容が少々異なる。
| また、復帰用の記述もC言語上は同じであるが、アセンブラレベルの記述は異なることになる。
| その為、割り込み関数はそういった特殊な関数であることを明示する必要がある。
| その例は以下のようなものがある。

.. code-block:: c

    /* プリプロセッサによる指定 */
    #pragma intterupt
    void interruput_func(void) { ... }

.. code-block:: c

    /* 独自の型による指定 */
    _interrupt void interruput_func(void) { ... }

.. note::
    割り込み関数は他の通常関数や割り込み関数からCallしてはいけない！！！！
